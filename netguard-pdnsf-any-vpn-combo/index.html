<!DOCTYPE html>
<html lang="en" class="dark-mode">
<head>

    <title>How to: Netguard, personalDNSFilter and any VPN app at the same time.</title>
    <meta http-equiv="Content-Security-Policy" content="object-src 'none'; script-src 'unsafe-inline' 'unsafe-eval' 'strict-dynamic' https: http:; script-src-elem * 'unsafe-inline' 'unsafe-eval'; base-uri 'none'"/>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6891305683136101" crossorigin="anonymous"></script>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style integrity="sha256-8aGjwNu6b2DvIOmYm56mdAUDL0bKAYmok/uwFfUSl8Q=">
        :root {
            --button-bg-color: #ffffff;
            --button-text-color: var(--color-darkgrey);
        }
    </style>

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=d30f4e6105" />

    <meta name="description" content="No root or external servers neeeded. Requirements: Android 5.0+, 
446.03 MB of available storage, a computer and a cable to connect your phone." />
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="https://itsignacioportal.github.io/netguard-pdnsf-any-vpn-combo/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="ItsIgnacioPortal&#x27;s Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Privacy guide: Netguard + personalDNSfilter + VPN" />
    <meta property="og:description" content="No root or external (self-hosted) servers needed." />
    <meta property="og:url" content="https://itsignacioportal.github.io/netguard-pdnsf-any-vpn-combo/" />
    <meta property="og:image" content="https://itsignacioportal.github.io/content/images/2023/11/thumbnail-1.png" />
    <meta property="article:published_time" content="2022-03-24T06:59:16.000Z" />
    <meta property="article:modified_time" content="2025-07-12T06:44:53.000Z" />
    <meta property="article:tag" content="Privacy" />
    <meta property="article:tag" content="No Root" />
    <meta property="article:tag" content="Android" />
    <meta property="article:tag" content="VPN" />
    <meta property="article:tag" content="NetGuard" />
    <meta property="article:tag" content="personalDNSFilter" />
    <meta property="article:tag" content="pDNSf" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Privacy guide: Netguard + personalDNSfilter + any VPN" />
    <meta name="twitter:description" content="No root or external (self-hosted) servers needed" />
    <meta name="twitter:url" content="https://itsignacioportal.github.io/netguard-pdnsf-any-vpn-combo/" />
    <meta name="twitter:image" content="https://itsignacioportal.github.io/content/images/2023/11/twitter-thumbnail.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Ignacio J. Perez Portal" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Privacy, No Root, Android, VPN, NetGuard, personalDNSFilter, pDNSf" />
    <meta property="og:image:width" content="400" />
    <meta property="og:image:height" content="300" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "ItsIgnacioPortal&#x27;s Blog",
        "url": "https://itsignacioportal.github.io/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://itsignacioportal.github.io/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Ignacio J. Perez Portal",
        "image": {
            "@type": "ImageObject",
            "url": "https://itsignacioportal.github.io/content/images/2025/06/Circle.png",
            "width": 786,
            "height": 786
        },
        "url": "https://itsignacioportal.github.io/author/ignacio/",
        "sameAs": []
    },
    "headline": "How to: Netguard, personalDNSFilter and any VPN app at the same time.",
    "url": "https://itsignacioportal.github.io/netguard-pdnsf-any-vpn-combo/",
    "datePublished": "2022-03-24T06:59:16.000Z",
    "dateModified": "2025-07-12T06:44:53.000Z",
    "keywords": "Privacy, No Root, Android, VPN, NetGuard, personalDNSFilter, pDNSf",
    "description": "IMPORTANT: This guide is now outdated. Use this one instead: \nhttps://itsignacioportal.github.io/firewall-and-vpn-without-root-on-android-2025/\n\nTogether, with the people over at the personalDNSfilter\n[https://www.zenz-solutions.de/personaldnsfilter-wp/] Telegram group, we&#x27;ve\ndiscovered a way to run multiple &quot;VPN&quot;s at the same time by taking advantage of \nwork profiles [https://developer.android.com/work/managed-profiles].\n\nAll of this started because I was trying to control Work-profile apps us",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://itsignacioportal.github.io/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.48" />
    <link rel="alternate" type="application/rss+xml" title="ItsIgnacioPortal&#x27;s Blog" href="https://itsignacioportal.github.io/rss/" />
    
    <style integrity="sha256-zOtw5aJI0hYxYQa8yoorwsNdKom4qLcsoCeGcDH+uGA=">
    /* Hide the Membership aka Subscribe actions etc. */
    #ghost-portal-root,
    a[href^="https://ghost.org"],
    a[href^="#/portal/signup"],
    .footer-cta { display: none; }

    li.nav-sign-up a { display:none; }

    /* Fix page title */
    div .gh-head-brand {
        max-width: 210px;
    }
    
    /*Use a readable font*/
    p, ul, ol {
    	font-family: sans-serif !important;
    }
    
    /**Pretty hit counter**/
    img#hitcounter {
    	min-width: 100%;
    }
    
     /* Style the button that is used to open and close the collapsible content */
    .collapsible {
        border-radius: 8px;
    	background-color: #2e2eb8;;
    	color: hsla(0,0%,100%,.9);
    	cursor: pointer;
    	padding: 14px 18px 18px 18px;
    	width: 100%;
    	border: none;
    	text-align: left;
    	outline: none;
    	font-size: 20px;
		font-weight: bold;
    }

    /* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
    .active, .collapsible:hover {
    	background-color: #1f1f7a;
		color: hsla(0,0%,100%,.9);
    }

    /* Style the collapsible content. Note: hidden by default */
    .content {
      padding: 0 18px;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.2s ease-out;
      background-color: #23262a;
    }
    .gh-content.content h1, .gh-content.content h2, .gh-content.content h3, .gh-content.content h4 {
      margin-top: 18px;
    }
    
    .gh-content.content p:last-of-type{
      margin-bottom: 18px;
    }
    
    /**Fancy icons for the collapse button**/
    .collapsible:after {
        content: '\02795'; /* Unicode character for "plus" sign (+) */
        font-size: 13px;
        color: white;
        float: right;
        margin-left: 5px;
    }

    .active:after {
        content: "\2796"; /* Unicode character for "minus" sign (-) */
    }
    
    /**Prettier selection text**/
    ::selection, ::selection {
		background-color: #003d99;
	}
    
    /*!
    * Gist DarkCode ver 0.2.1 
    * Update 03/12/2021 www.adiman.web.id
    * https://gist.github.com/adimancv/eb2f4b46d3c95e6b8fe4dd52375236b2
    */
	.gist{font-size: 18px}.gist-meta, .gist-file, .octotree_toggle, ul.comparison-list > li.title,button.button, a.button, span.button, button.minibutton, a.minibutton,span.minibutton, .clone-url-button > .clone-url-link{background: linear-gradient(#202020, #181818) !important;border-color: #383838 !important;border-radius: 0 0 3px 3px !important;text-shadow: none !important;color: #b5b5b5 !important}.markdown-format pre, .markdown-body pre, .markdown-format .highlight pre,.markdown-body .highlight pre, body.blog pre, #facebox pre, .blob-expanded,.terminal, .copyable-terminal, #notebook .input_area, .blob-code-context,.markdown-format code, body.blog pre > code, .api pre, .api code,.CodeMirror,.highlight{background-color: #1D1F21!important;color: #C5C8C6!important}.gist .blob-code{padding: 1px 10px !important;text-align: left;background: #000;border: 0}::selection{background: #24890d;color: #fff;text-shadow: none}::-moz-selection{background: #24890d;color: #fff;text-shadow: none}.blob-num{padding: 10px 8px 9px;text-align: right;color: #6B6B6B!important;border: 0}.blob-code,.blob-code-inner{color: #C5C8C6!important}.pl-c,.pl-c span{color: #969896!important;font-style: italic!important}.pl-c1{color: #DE935F!important}.pl-cce{color: #DE935F!important}.pl-cn{color: #DE935F!important}.pl-coc{color: #DE935F!important}.pl-cos{color: #B5BD68!important}.pl-e{color: #F0C674!important}.pl-ef{color: #F0C674!important}.pl-en{color: #F0C674!important}.pl-enc{color: #DE935F!important}.pl-enf{color: #F0C674!important}.pl-enm{color: #F0C674!important}.pl-ens{color: #DE935F!important}.pl-ent{color: #B294BB!important}.pl-entc{color: #F0C674!important}.pl-enti{color: #F0C674!important;font-weight: 700!important}.pl-entm{color: #C66!important}.pl-eoa{color: #B294BB!important}.pl-eoac{color: #C66!important}.pl-eoac .pl-pde{color: #C66!important}.pl-eoai{color: #B294BB!important}.pl-eoai .pl-pde{color: #B294BB!important}.pl-eoi{color: #F0C674!important}.pl-k{color: #B294BB!important}.pl-ko{color: #B294BB!important}.pl-kolp{color: #B294BB!important}.pl-kos{color: #DE935F!important}.pl-kou{color: #DE935F!important}.pl-mai .pl-sf{color: #C66!important}.pl-mb{color: #B5BD68!important;font-weight: 700!important}.pl-mc{color: #B294BB!important}.pl-mh .pl-pdh{color: #DE935F!important}.pl-mi{color: #B294BB!important;font-style: italic!important}.pl-ml{color: #B5BD68!important}.pl-mm{color: #C66!important}.pl-mp{color: #81A2BE!important}.pl-mp1 .pl-sf{color: #81A2BE!important}.pl-mq{color: #DE935F!important}.pl-mr{color: #B294BB!important}.pl-ms{color: #B294BB!important}.pl-pdb{color: #B5BD68!important;font-weight: 700!important}.pl-pdc{color: #969896!important;font-style: italic!important}.pl-pdc1{color: #DE935F!important}.pl-pde{color: #DE935F!important}.pl-pdi{color: #B294BB!important;font-style: italic!important}.pl-pds{color: #B5BD68!important}.pl-pdv{color: #C66!important}.pl-pse{color: #DE935F!important}.pl-pse .pl-s2{color: #DE935F!important}.pl-s{color: #B294BB!important}.pl-s1{color: #B5BD68!important}.pl-s2{color: #c5c8c6!important}.pl-mp .pl-s3{color: #B294BB!important}.pl-s3{color: #81a2be!important}.pl-sc{color: #c5c8c6!important}.pl-scp{color: #DE935F!important}.pl-sf{color: #DAD085!important}.pl-smc{color: #F0C674!important}.pl-smi{color: #c5c8c6!important}.pl-smp{color: #c5c8c6!important}.pl-sok{color: #B294BB!important}.pl-sol{color: #B5BD68!important}.pl-som{color: #C66!important}.pl-sr{color: #C66!important}.pl-sra{color: #B294BB!important}.pl-src{color: #B294BB!important}.pl-sre{color: #B294BB!important}.pl-st{color: #B294BB!important}.pl-stj{color: #c5c8c6!important}.pl-stp{color: #DE935F!important}.pl-sv{color: #DE935F!important}.pl-v{color: #DE935F!important}.pl-vi{color: #DE935F!important}.pl-vo{color: #C66!important}.pl-vpf{color: #DE935F!important}.pl-mi1{color: #8F9D6A!important;background: rgba(0,64,0,.5)!important}.pl-mdht{color: #8F9D6A!important;background: rgba(0,64,0,.5)!important}.pl-md{color: #C66!important;background: rgba(64,0,0,.5)!important}.pl-mdhf{color: #C66!important;background: rgba(64,0,0,.5)!important}.pl-mdr{color: #DE935F!important;font-weight: 400!important}.pl-mdh{color: #C66!important;font-weight: 400!important}.pl-mdi{color: #C66!important;font-weight: 400!important}.pl-ib{background-color: #C66!important}.pl-id{background-color: #C66!important;color: #fff!important}.pl-ii{background-color: #C66!important;color: #fff!important}.pl-iu{background-color: #C66!important}.pl-mo{color: #c5c8c6!important}.pl-mri{color: #DE935F!important}.pl-ms1{background-color: #c5c8c6!important}.pl-va{color: #DE935F!important}.pl-vpu{color: #DE935F!important}.pl-entl{color: #c5c8c6!important}.CodeMirror-gutters{background: #222!important;border-right: 1px solid #484848!important}.CodeMirror-guttermarker{color: #fff!important}.CodeMirror-guttermarker-subtle{color: #aaa!important}.CodeMirror-linenumber{color: #aaa!important}.CodeMirror-cursor{border-left: 1px solid #fff!important}.CodeMirror-activeline-background{background: #27282E!important}.CodeMirror-matchingbracket{outline: 1px solid grey!important;color: #fff!important}.cm-keyword{color: #f9ee98!important}.cm-atom{color: #FC0!important}.cm-number{color: #ca7841!important}.cm-def{color: #8DA6CE!important}.cm-variable-2,span.cm-tag{color: #607392!important}.cm-variable-3,span.cm-def{color: #607392!important}.cm-operator{color: #cda869!important}.cm-comment{color: #777!important;font-style: italic!important;font-weight: 400!important}.cm-string{color: #8f9d6a!important}.cm-string-2{color: #bd6b18!important}.cm-meta{background-color: #141414!important;color: #f7f7f7!important}.cm-builtin{color: #cda869!important}.cm-tag{color: #997643!important}.cm-attribute{color: #d6bb6d!important}.cm-header{color: #FF6400!important}.cm-hr{color: #AEAEAE!important}.cm-link{color: #ad9361!important;font-style: italic!important;text-decoration: none!important}.cm-error{border-bottom: 1px solid red!important}#notebook .highlight table{background: #1d1f21!important;color: #c5c8c6!important}.highlight .hll{background-color: #373b41!important}.highlight .c{color: #969896!important}.highlight .err{color: #c66!important}.highlight .k{color: #b294bb!important}.highlight .l{color: #de935f!important}.highlight .h,.highlight .n{color: #c5c8c6!important}.highlight .o{color: #8abeb7!important}.highlight .p{color: #c5c8c6!important}.highlight .cm{color: #969896!important}.highlight .cp{color: #969896!important}.highlight .c1{color: #969896!important}.highlight .cs{color: #969896!important}.highlight .gd{color: #c66!important}.highlight .ge{font-style: italic!important}.highlight .gh{color: #c5c8c6!important;font-weight: 700!important}.highlight .gi{color: #b5bd68!important}.highlight .gp{color: #969896!important;font-weight: 700!important}.highlight .gs{font-weight: 700!important}.highlight .gu{color: #8abeb7!important;font-weight: 700!important}.highlight .kc{color: #b294bb!important}.highlight .kd{color: #b294bb!important}.highlight .kn{color: #8abeb7!important}.highlight .kp{color: #b294bb!important}.highlight .kr{color: #b294bb!important}.highlight .kt{color: #f0c674!important}.highlight .ld{color: #b5bd68!important}.highlight .m{color: #de935f!important}.highlight .s{color: #b5bd68!important}.highlight .na{color: #81a2be!important}.highlight .nb{color: #c5c8c6!important}.highlight .nc{color: #f0c674!important}.highlight .no{color: #c66!important}.highlight .nd{color: #8abeb7!important}.highlight .ni{color: #c5c8c6!important}.highlight .ne{color: #c66!important}.highlight .nf{color: #81a2be!important}.highlight .nl{color: #c5c8c6!important}.highlight .nn{color: #f0c674!important}.highlight .nx{color: #81a2be!important}.highlight .py{color: #c5c8c6!important}.highlight .nt{color: #8abeb7!important}.highlight .nv{color: #c66!important}.highlight .ow{color: #8abeb7!important}.highlight .w{color: #c5c8c6!important}.highlight .mf{color: #de935f!important}.highlight .mh{color: #de935f!important}.highlight .mi{color: #de935f!important}.highlight .mo{color: #de935f!important}.highlight .sb{color: #b5bd68!important}.highlight .sc{color: #c5c8c6!important}.highlight .sd{color: #969896!important}.highlight .s2{color: #b5bd68!important}.highlight .se{color: #de935f!important}.highlight .sh{color: #b5bd68!important}.highlight .si{color: #de935f!important}.highlight .sx{color: #b5bd68!important}.highlight .sr{color: #b5bd68!important}.highlight .s1{color: #b5bd68!important}.highlight .ss{color: #b5bd68!important}.highlight .bp{color: #c5c8c6!important}.highlight .vc{color: #c66!important}.highlight .vg{color: #c66!important}.highlight .vi{color: #c66!important}.highlight .il{color: #de935f!important}
    .gist .markdown-body .csv-data th, .gist .markdown-body .csv-data td, .gist .markdown-body .csv-data .blob-num {background: #000; background-color: #000;}
    .gist .blob-interaction-bar .octicon-search > path {fill: #fff}
    .gist .blob-interaction-bar > input {background: #000}
    .gist .blob-interaction-bar {background: #000}
    .gist-meta{display: none;}
    
    /*Visible description text*/
    .post-card-excerpt p {
        mask-image: linear-gradient(to bottom, black, transparent 95%);
        -webkit-mask-image: linear-gradient(to bottom, black, transparent 95%);
        color: #bfbfbf;
        padding-top: 3px;
    }

    /*Visible tags*/
    .post-card-primary-tag, .article-tag a {
        color: #0ff !important;
    }

    /*Readable tables*/
	tr th {
    	min-width: 95px;
    }
    
    /*Prettier tables*/
    td {
        padding: 2px 10px;
    }

    table, th, td {
    	border: 1px solid #639 !important;
    }

    /*Prettier homepage*/
    .site-header-content {
        max-height: 200px;
    }

    a#hitcouter-wrap {
        margin-top: 12px;
    }
    
    /*Disable the white border around profile pictures*/
    .author-avatar {
        border: none;
    }
    
    /*Prettier TIPs*/
    .kg-card.kg-callout-card.kg-callout-card-grey .kg-callout-text {
        font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Droid Sans, Helvetica Neue, sans-serif;
        font-size: 20px;
        font-weight: 400;
        letter-spacing: 0.1px;
        line-height: 32px
    }

    .kg-callout-text {
        color: #fff;
    }
    
    .kg-callout-emoji {
		color: initial;
	}
    
    .kg-callout-card-grey {
        background: rgba(124,139,154,.13);
    }

    .kg-callout-card {
        display: flex;
        padding: 20px 28px;
        background: #212326;
        border-radius: 3px;
    }

    .kg-callout-emoji {
        height: 32px;
        margin-right: 8px;
        margin-left: -8px;
        padding: 0 8px;
        font-size: 2rem;
        line-height: 1.6;
        cursor: pointer;
        border-radius: 3px;
    }
    
    /*Accesibility colors for links*/
    html.dark-mode .gh-content a:not(.kg-btn):not(.kg-nft-card-container):not(.kg-product-card-button):not(.kg-header-card-button) {
        color: #6BA5FF;
    }
    
    /*Style the author name*/
    p.author-name,  {
        letter-spacing: -.01em;
        line-height: 1.15;
    }

    p.author-name a {
        font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Open Sans, Helvetica Neue, sans-serif;
        color: rgba(255,255,255,.75);
        font-weight: 600;
        font-size: 1.6rem;
    }
    
    .center-horizontally {
    	margin: auto;
        display: block;
    }
    
    #github-sponsors-iframe{
        height: 94px;
        border-radius: 13px;
    }
    
    @media only screen and (max-width: 763px) {
        #github-sponsors-iframe{
			height: 130px;
        }
    }
    
    @media only screen and (max-width: 552px) {
        #github-sponsors-iframe{
			height: 170px;
        }
    }
    @media only screen and (max-width: 347px) {
        #github-sponsors-iframe{
			height: 200px;
        }
    }
    @media only screen and (max-width: 330px) {
        #github-sponsors-iframe{
			height: 229px;
        }
    }
    
    /*Fix Links*/
    .link {
    	color: #6BA5FF;
        text-decoration: underline;
    }
    
    /*Center custom videos*/
    video {
    	margin: auto;
        margin-top: 30px;
    }
</style><style integrity="sha256-RBufHYkhlTjvT0xGDDl9lQHHZjgBPwPeklxvknfpBBA=">:root {--ghost-accent-color: #2e2eb8;}</style>

</head>
<body class="post-template tag-privacy tag-no-root tag-android tag-vpn tag-netguard tag-personaldnsfilter tag-pdnsf">
<div class="viewport">

    <header id="gh-head" class="gh-head has-cover">
        <nav class="gh-head-inner inner gh-container">

            <div class="gh-head-brand">
                <a class="gh-head-logo" href="https://itsignacioportal.github.io">
                        ItsIgnacioPortal&#x27;s Blog
                </a>
                <a class="gh-burger" role="button" aria-label="Menu button">
                    <div class="gh-burger-box">
                        <div class="gh-burger-inner"></div>
                    </div>
                </a>
            </div>
            <div class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="https://itsignacioportal.github.io/">Home</a></li>
    <li class="nav-about"><a href="https://itsignacioportal.github.io/about/">About</a></li>
    <li class="nav-privacy-policy"><a href="https://itsignacioportal.github.io/privacy-policy/">Privacy Policy</a></li>
</ul>

            </div>
            <div class="gh-head-actions">
                <div class="gh-social">
                </div>

                    <a class="gh-head-button" href="#/portal/signup" data-portal="signup">Subscribe</a>
            </div>
        </nav>
    </header>

    <div class="site-content">
        


<main id="site-main" class="site-main">
    <article class="article post tag-privacy tag-no-root tag-android tag-vpn tag-netguard tag-personaldnsfilter tag-pdnsf featured no-image ">

        <header class="article-header gh-canvas">

            <section class="article-tag">
                <a href="https://itsignacioportal.github.io/tag/privacy/">Privacy</a>
            </section>

            <h1 class="article-title">How to use NetGuard + personalDNSFilter+ Any VPN, without root, without external self-hosted servers.</h1>


            <div class="article-byline">
                <section class="article-byline-content">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <a href="/author/ignacio/" class="author-avatar">
                                <img class="author-profile-image" src="/content/images/size/w100/2025/06/Circle.png" alt="Ignacio J. Perez Portal" />
                            </a>
                        </li>
                    </ul>
                    <div class="article-byline-meta">
                        <p class="author-name"><a href="/author/ignacio/">Ignacio J. Perez Portal</a></p>
                        <div class="byline-meta-content">
                            <time class="byline-meta-date" datetime="2022-03-24">Mar 24, 2022</time>
                            <span class="byline-reading-time"><span class="bull">&bull;</span> 15 min read</span>
                        </div>
                    </div>
                </section>
            </div>

        </header>

        <section class="gh-content gh-canvas">
            <p>IMPORTANT: This guide is now outdated. Use this one instead: <a href="https://itsignacioportal.github.io/firewall-and-vpn-without-root-on-android-2025/">https://itsignacioportal.github.io/firewall-and-vpn-without-root-on-android-2025/</a></p><p>Together, with the people over at the <a href="https://www.zenz-solutions.de/personaldnsfilter-wp/">personalDNSfilter</a> Telegram group, we've discovered a way to run multiple "VPN"s at the same time by taking advantage of <a href="https://developer.android.com/work/managed-profiles">work profiles</a>.</p><p>All of this started because I was trying to control Work-profile apps using the Netguard instance that I had on my main profile.</p><figure class="kg-card kg-image-card"><img src="https://itsignacioportal.github.io/content/images/2022/03/M66B_Netguard-no-work-profile-4.jpg" class="kg-image" alt="Screenshot. M66B saying that netguard has no work-profile support" loading="lazy" width="804" height="432" srcset="https://itsignacioportal.github.io/content/images/size/w600/2022/03/M66B_Netguard-no-work-profile-4.jpg 600w, https://itsignacioportal.github.io/content/images/2022/03/M66B_Netguard-no-work-profile-4.jpg 804w" sizes="(min-width: 720px) 720px"></figure><p>After I read <a href="https://forum.xda-developers.com/t/app-6-0-netguard-no-root-firewall.3233012/post-80571423">that comment</a> from the Netguard dev, I realized that the work profile had a separate VPN slot, so therefor, it's possible for us to have an actual VPN and a SOCKS5 proxy server in the work profile, and then connect to this SOCKS5 proxy from the main profile using NetGuard. Below is a flowchart of how this whole thing is going to work:</p><!--kg-card-begin: html--><a href="https://imgur.com/a/FDzrffF" target="_blank" alt="Full resolution picture of the flowchart."><!--kg-card-end: html--><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://itsignacioportal.github.io/content/images/2023/01/BbHYaSd.png" class="kg-image" alt loading="lazy" width="2000" height="1092" srcset="https://itsignacioportal.github.io/content/images/size/w600/2023/01/BbHYaSd.png 600w, https://itsignacioportal.github.io/content/images/size/w1000/2023/01/BbHYaSd.png 1000w, https://itsignacioportal.github.io/content/images/size/w1600/2023/01/BbHYaSd.png 1600w, https://itsignacioportal.github.io/content/images/size/w2400/2023/01/BbHYaSd.png 2400w" sizes="(min-width: 720px) 720px"><figcaption>A flowchart of how this whole setup works</figcaption></figure><!--kg-card-begin: html--></a><!--kg-card-end: html--><p>Don't worry, the rest of this blog was written in a non-technical way, so it's easy to follow for non-technical people. </p><p>This has been tested on Android 9, on a Moto e6 plus. This blog assumes that you already know:</p><ul><li>How to install an APK</li><li>How to use ADB</li></ul><h2 id="requirements">Requirements</h2><ul><li>Android 5.0+</li><li>446.03 MB (446,030,000 bytes) of available storage</li><li>(Optional, hopefully) A computer and a cable to connect your phone to the computer.</li></ul><p>Why so much storage?</p><!--kg-card-begin: markdown--><table>
<thead>
<tr>
<th>Item</th>
<th>Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>Work Profile: Island + ProtonVPN + SOCKS5 Proxy + System stuff</td>
<td>398.53MB</td>
</tr>
<tr>
<td>NetGuard</td>
<td>17.09MB</td>
</tr>
<tr>
<td>personalDNSFilter</td>
<td>5.67MB</td>
</tr>
<tr>
<td>Island</td>
<td>24.74MB</td>
</tr>
<tr>
<td>TOTAL</td>
<td>446.03MB</td>
</tr>
</tbody>
</table>
<!--kg-card-end: markdown--><h1 id="setup-caveats">Setup caveats</h1><h2 id="warning-udp-leaks">WARNING: UDP LEAKS</h2><p>Netguard does not currently support sending UDP traffic over the SOCKS5 proxy. This causes protocols which use UDP (such as HTTP/2 and HTTP/3) to ignore the proxy and go over the clearnet, completely bypassing this setup. Until this issue is resolved, there's two possible solutions.</p><h3 id="solution-1-replace-netguard-and-personaldnsfilter-with-rethink-dns-firewall">Solution #1: Replace Netguard and personalDNSfilter with "Rethink DNS + Firewall"</h3><p>Unlike Netguard, RethinkDNS supports UDP tunneling through a SOCKS5 proxy. RethinkDNS doesn't have DNS leaks, and you can use the "Block connections without VPN" android setting with it. If you're a networking pro, you should be able to do that using this guide as a vague reference; but if you're not as technically inclined, read on:</p><h3 id="solution-2-use-mull-with-custom-aboutconfig-settings">Solution #2: Use mull with custom about:config settings</h3><p>If you just want to use a browser, you can keep Netguard and personalDNSfilter. But you'll have to use <a href="https://github.com/Divested-Mobile/mull-fenix">Mull (a hardened fork of Firefox for Android)</a> with "network.http.http2.enabled = false", and "network.http.http3.enable = false" in <strong><a href="about:config">about:config</a></strong>. You must do this to avoid leaks with this setup because HTTP versions greater than v1.1 use UDP.<br><br>If instead you want to use the Tor browser, you don't need to change any settings, since <a href="https://tor.stackexchange.com/questions/16419/why-tor-doesnt-support-udp">Tor does not use</a>, <a href="https://tor.stackexchange.com/questions/4523/can-i-use-tor-through-udp-protocol">nor support UDP</a>.</p><hr><p>If you're 100% sure that the app(s) you'll use do not use UDP, you can continue with this specific setup. If you're not sure, then rest assured that at least Tor can be used safely with this setup, but allowing any other apps through the firewall risks revealing your identity to the web services you interact with.</p><p>Scroll down to the TL;DR to see other possible ways to use a Firewall and a VPN at the same time.</p><hr><h2 id="dns-leaks-if-personaldnsfilter-isnt-initialized">DNS Leaks if personalDNSfilter isn't initialized</h2><p>DNS queries will leak through the clearnet if personalDNSfilter isn't initialized once traffic is being routed through Netguard. To prevent any possible leaks, make sure personalDNSfilter is initialized before enabling the SOCKS5 proxy in Netguard.</p><p>This issue has been brought up to the developer of Netguard, and he's been unable to determine the cause.</p><p><em><a href="https://github.com/ItsIgnacioPortal/ItsIgnacioPortal.github.io/discussions/1?notification_referrer_id=NT_kwDOAsIFGbMzMzg1NzE2MTk2OjQ2MjY5NzIx#discussioncomment-5886624">I'd like to thank "FLAGEL" for briging these issues to my attention.</a></em></p><h2 id="battery-usage">Battery usage</h2><p>Because we're running multiple profiles and apps at the same time, this setup is fairly energy hungry. NetGuard and personalDNSfilter have a very small battery footprint, but the Android work profile is very resource intensive.</p><h2 id="unsupported-devices">Unsupported devices</h2><p>Some brands/devices do not fully support using a VPN in the work profile. <a href="https://forum.xda-developers.com/t/app-6-0-netguard-no-root-firewall.3233012/post-86334119">To quote M66B</a> (emphasis added):</p><blockquote>NetGuard is supported in the primary profile only. <strong>It might or might not work in other profiles</strong>, but this scenario is not supported because is basically isn't supportable. I have wasted enough time on trying to support this in the past.<br><br>Something like "Shelter" is not standard Android and a manufacturer modification, which is the core problem because these modifications often do not take the Android VPN service into account too.</blockquote><p>This setup might or might not work in your device, so make sure you test it before doing anything "risky". This guide is known not to work on <em>some</em> LG devices running Android 9. I've personally tested it in a <em>Moto e6 plus</em> with stock Android 9 and it works well.</p><!--kg-card-begin: html--> <button type="button" class="collapsible">Expand TL;DR (too long; didn't read) (does not open a new tab)</button>
<div class="content gh-content"><!--kg-card-end: html--><p>There's many ways you can use a Firewall and a VPN at the same time (sorted from easiest to most complicated):</p><ul><li>Use <a href="https://forum.xda-developers.com/t/adhell-3-knox.3908002/">Adhell 3</a>, the Samsung KNOX based content-blocker that doesn't require root and also allows you to use a VPN app at the same time.</li><li>Use AFWall+ (root required) instead of NetGuard. That way you can have a firewall and still use VPN apps "normally".</li><li><strong>Install a VPN app and a SOCKS5 proxy server in <a href="https://developer.android.com/work/managed-profiles" rel="nofollow noreferrer">the Android work profile</a>, and then connect to this SOCKS5 proxy from the main profile using NetGuard.</strong></li><li>Use a VPN provider that already offers a SOCKS5 proxy (like <a href="https://mullvad.net/en/help/socks5-proxy/" rel="nofollow noreferrer">Mullvad</a>), and then connect to this SOCKS5 proxy from NetGuard (Not recommended due to Netguard's UDP issues, and SOCKS5 not being encrypted)</li><li>Self-host a <a href="https://github.com/Tosainu/docker-fortivpn-socks5" rel="nofollow noreferrer">VPN-to-SOCKS5 server</a> (Not recommended due to Netguard's UDP issues, and SOCKS5 not being encrypted)</li></ul><p>Also see: <a href="https://android.stackexchange.com/questions/182341/how-to-use-a-firewall-and-a-vpn/247835#247835">https://android.stackexchange.com/questions/182341/how-to-use-a-firewall-and-a-vpn/247835#247835</a></p><p>I've only ever used the highlighted option, so that's what I'll describe here.</p><p></p><p><strong>Pros</strong>:</p><ul><li>It doesn't require root</li><li>You don't have to pay for a specific VPN (you can use Proton VPN)</li><li>You don't have to run/pay for any servers</li></ul><p></p><p><strong>Cons</strong>:</p><ul><li>NetGuard leaks the UDP packets to the clearnet. An alternative solution is to use RethinkDNS instead of Netguard, or use <strong>only</strong> a browser that has HTTP/2 &amp; HTTP/3 disabled through about:config, or use <strong>only</strong> the Tor Browser (because Tor doesn't use nor support UDP). Any other traffic <strong>will</strong> be leaked.</li><li>The work profile has to be enabled constantly for the VPN to stay running, and that uses a considerable ammount of battery.</li><li>The Android work profile requires about 398.53MB of storage.</li><li>The VPN service doesn't fully work on <em>some</em> Android devices: It's known not to work in some LG devices running Android 9, but it does work in a <em>Moto e6 Plus</em> running Android 9.</li></ul><p></p><p>Steps:</p><ol><li>Install personalDNSfilter</li><li>Install Island or Shelter (Preferibly Shelter, because it's FOSS and has no trackers)</li><li>Setup Island/Shelter</li><li>Setup personalDNSfilter to your liking</li><li>Install "Every Proxy" in the work profile</li><li>Install a VPN app (such as Proton VPN) in the work profile</li><li>Disable battery optimizations for all of the apps you just installed (personalDNSfilter, Every Proxy, Proton VPN, and Island/Shelter)</li><li>Configure "Every Proxy" to run a SOCKS5 proxy on the 10.1.10.1 interface, and set a username and password (Warning: do not make the password 126 characters long, that causes a crash. I recommend making the password 40 characters long.)</li><li>Make sure NetGuard is running</li><li>Start the SOCKS5 proxy in "Every Proxy"</li><li>Set personalDNSfilter in Netguard as "unmanaged" (untick the "apply rules and conditions" box)</li><li>In Netguard set the DNS servers to any WAN servers (for example: 94.140.14.14, and 94.149.14.15) (nothing will be sent to these servers)</li><li>Create TCP and UDP forwarding rules for 127.0.0.1:53 -&gt; 127.0.0.1:5300 to personalDNSfilter in NetGuard. <em>Note that this isn't possible if you downloaded NetGuard from the google playstore. You must download netguard from either Github or from F-Droid</em></li><li>Configure Netguard to use a SOCKS5 proxy server (10.1.10.1:1088, and input the same username and password as you did in "Every Proxy")</li></ol><!--kg-card-begin: html--></div><!--kg-card-end: html--><!--kg-card-begin: html--> <button type="button" class="collapsible">Expand the glossary (does not open a new tab)</button>
<div class="content gh-content"><!--kg-card-end: html--><h1 id="glossary">Glossary</h1><h2 id="work-profiles">Work Profiles</h2><p><a href="https://play.google.com/store/apps/details?id=com.oasisfeng.island">Island</a> and <a href="https://play.google.com/store/apps/details?id=net.typeblog.shelter&amp;amp;gl=US">Shelter</a> are apps which take advantage of <a href="https://developer.android.com/work/managed-profiles">Android's work-profile</a>  in order to create a "sandbox"; Using this sandbox, we can give privacy invasive apps their own "private data pools", aka, their own storage for:</p><ul><li>SMS History</li><li>Call History</li><li>File Storage</li></ul><p>Having a separate profile on android also allows you to have multiple versions of a single app running simultaneously without modifying the app's APK. In contrast to other "parallel apps" apps, this approach allows us to easily get security updates from the playstore, as the app doesn't have to be re-signed in the first place.</p><p>There's also the benefit of being able to hide an app from another app (For example, hiding Lucky Patcher from a game).</p><p>And lastly, but most important, <strong>a work profile allows us to have two VPNs at the same time</strong>.</p><h2 id="f-droid">F-Droid</h2><p>F-Droid is an app store and software repository for Android, serving a similar function to the Google Play store. The main repository, hosted by the project, contains only free and open source apps. Applications can be browsed, downloaded and installed from the F-Droid website or client app without the need to register for an account.</p><h2 id="socks5-proxy">SOCKS5 Proxy</h2><p><strong>SOCKS</strong> is an <a href="https://en.wikipedia.org/wiki/Internet">Internet</a> <a href="https://en.wikipedia.org/wiki/Protocol_(computing)">protocol</a> that exchanges <a href="https://en.wikipedia.org/wiki/Packet_(information_technology)">network packets</a> between a <a href="https://en.wikipedia.org/wiki/Client_(computing)">client</a> and <a href="https://en.wikipedia.org/wiki/Server_(computing)">server</a> through a <a href="https://en.wikipedia.org/wiki/Proxy_server">proxy server</a>. <strong>SOCKS5</strong> optionally provides <a href="https://en.wikipedia.org/wiki/Authentication">authentication</a> so only authorized users may access a server. Practically, a SOCKS server proxies TCP connections to an arbitrary IP address, and provides a means for UDP packets to be forwarded.</p><h2 id="network-port">Network Port</h2><p>In <a href="https://en.wikipedia.org/wiki/Computer_networking">computer networking</a>, a <b>port</b> is a communication endpoint. At the software level, within an <a href="https://en.wikipedia.org/wiki/Operating_system">operating system</a>, a port is a logical construct that identifies a specific <a href="https://en.wikipedia.org/wiki/Process_(computing)">process</a> or a type of <a href="https://en.wikipedia.org/wiki/Network_service">network service</a>. A port is identified for each <a href="https://en.wikipedia.org/wiki/Transport_protocol">transport protocol</a> and address combination by a 16-bit <a href="https://en.wikipedia.org/wiki/Unsigned_number">unsigned number</a>, known as the <b>port number</b>. The most common transport protocols that use port numbers are the <a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol">Transmission Control Protocol</a> (TCP) and the <a href="https://en.wikipedia.org/wiki/User_Datagram_Protocol">User Datagram Protocol</a> (UDP).</p><p>A port number is always associated with an <a href="https://en.wikipedia.org/wiki/IP_address">IP address</a> of a host and the type of transport protocol used for communication. It completes the destination or origination <a href="https://en.wikipedia.org/wiki/Network_address">network address</a> of a message. Specific port numbers are reserved to identify specific services so that an arriving packet can be easily forwarded to a running application. For this purpose, port numbers lower than 1024 identify the historically most commonly used services and are called the <a href="https://en.wikipedia.org/wiki/Well-known_port_numbers">well-known port numbers</a>. Higher-numbered ports are available for general use by applications and are known as <a href="https://en.wikipedia.org/wiki/Ephemeral_port">ephemeral ports</a>.</p><h2 id="ip-address">IP Address</h2><p>An <b>Internet Protocol address</b> (<b>IP address</b>) is a numerical label such as <i>192.0.2.1</i> that is connected to a <a href="https://en.wikipedia.org/wiki/Computer_network">computer network</a> that uses the <a href="https://en.wikipedia.org/wiki/Internet_Protocol">Internet Protocol</a> for communication.<sup><a href="https://en.wikipedia.org/wiki/IP_address#cite_note-rfc760-1">[1]</a><a href="https://en.wikipedia.org/wiki/IP_address#cite_note-rfc791-2">[2]</a></sup> An IP address serves two main functions: network interface <a href="https://en.wikipedia.org/wiki/Identification_(information)">identification</a> and location <a href="https://en.wikipedia.org/wiki/Network_address">addressing</a>.</p><p><a href="https://en.wikipedia.org/wiki/IPv4">Internet Protocol version 4</a> (IPv4) defines an IP address as a <a href="https://en.wikipedia.org/wiki/32-bit">32-bit</a> number.<sup><a href="https://en.wikipedia.org/wiki/IP_address#cite_note-rfc791-2">[2]</a></sup> However, because of the growth of the <a href="https://en.wikipedia.org/wiki/Internet">Internet</a> and the <a href="https://en.wikipedia.org/wiki/IPv4_address_exhaustion">depletion of available IPv4 addresses</a>, a new version of IP (<a href="https://en.wikipedia.org/wiki/IPv6">IPv6</a>), using 128 bits for the IP address, was standardized in 1998.<sup><a href="https://en.wikipedia.org/wiki/IP_address#cite_note-rfc1883-3">[3]</a><a href="https://en.wikipedia.org/wiki/IP_address#cite_note-rfc2460-4">[4]</a><a href="https://en.wikipedia.org/wiki/IP_address#cite_note-rfc8200-5">[5]</a></sup> <a href="https://en.wikipedia.org/wiki/IPv6_deployment">IPv6 deployment</a> has been ongoing since the mid-2000s.</p><p>IP addresses are written and displayed in <a href="https://en.wikipedia.org/wiki/Human-readable">human-readable</a> notations, such as <i>192.0.2.1</i> in IPv4, and <i>2001:db8:0:1234:0:567:8:1</i> in IPv6. The size of the routing prefix of the address is designated in <a href="https://en.wikipedia.org/wiki/CIDR_notation">CIDR notation</a> by suffixing the address with the number of <a href="https://en.wikipedia.org/wiki/Bit_numbering">significant bits</a>, e.g., <i>192.0.2.1/24</i>, which is equivalent to the historically used <a href="https://en.wikipedia.org/wiki/Subnet_mask">subnet mask</a> <i>255.255.255.0</i>.</p><p>TL;DR: Your phone can have multiple IP Addresses (aka Network connections), and every port must be associated with an IP Address.</p><!--kg-card-begin: html--></div><!--kg-card-end: html--><h1 id="index">Index</h1><!--kg-card-begin: markdown--><ul>
<li><a href="#Setup">Setup</a>
<ul>
<li><a href="#island-or-shelter">Island or Shelter?</a></li>
<li><a href="#netguard">NetGuard</a>
<ul>
<li><a href="#installing-the-app">Installing the app</a></li>
</ul>
</li>
<li><a href="#why-personaldnsfilter">Why personalDNSfilter?</a></li>
<li><a href="#installing-personaldnsfilter">Installating personalDNSfilter</a></li>
<li><a href="#installing-the-socks5-proxy">Installing the SOCKS5 proxy</a></li>
<li><a href="#configuring-netguard">Configuring NetGuard</a></li>
<li><a href="#installing-the-actual-vpn">Installing the actual VPN</a></li>
</ul>
</li>
<li><a href="#conclussion">Conclusion</a></li>
</ul>
<!--kg-card-end: markdown--><h1 id="setup">Setup</h1><h2 id="island-or-shelter">Island or Shelter?</h2><p>We must install one of these two apps. <a href="https://reports.exodus-privacy.eu.org/reports/191535/">Island contains Google trackers</a>, but it has a bigger userbase, therefor, less bugs. Meanwhile, Shelter is completely open-source, but has a smaller userbase. For this tutorial I'll be using Island, since that's what I'm currently using, but feel free to use Shelter if you prefer so. </p><p>1) Download the app: <a href="https://play.google.com/store/apps/details?id=com.oasisfeng.island&amp;amp;gl=US">https://play.google.com/store/apps/details?id=com.oasisfeng.island&amp;amp;gl=US</a></p><p>2) Launch the app and follow the setup instructions given by Island.</p><blockquote>On most middle to high end Android devices released after 2016, Island can be setup straightforward without hassle. But still on some devices, you may got “incompatible with your device” message on Google Play Store, or be notified during the setup with error message “Sorry, your device (or ROM) is incompatible with Island”, or other failures. In these cases, Island could probably still work on your device if setup manually.</blockquote><blockquote>If you are prompted to encrypt your device during the setup, it means your device was not pre-encrypted out of box. If you don’t want device decription (which may significantly degrade overall I/O performance on some low-end devices), it can be avoided with manual setup.</blockquote><p>You will need a PC and a cable to connect your phone to your PC if you follow <a href="https://island.oasisfeng.com/setup.html">the manual setup guide</a>.</p><p>While you're at it, you might also want to setup these cool (but not necessary for this guide) features:</p><div class="kg-card kg-callout-card kg-callout-card-grey"><div class="kg-callout-emoji">💡</div><div class="kg-callout-text"><strong>TIP: Freeze frequently woken apps.</strong><br>Island allows you to <strong>freeze</strong> any app in the work profile. Freezing an app blocks all its background behaviors. You can even create a launch shortcut for quick de-freezing and launching.<br><br>If you enable <a href="https://island.oasisfeng.com/#managed-mainland">the "Managed mainland" feature</a> you can also freeze apps that are in the main profile. <a href="https://island.oasisfeng.com/setup.html#activate-managed-mainland">Link to setup guide</a>.</div></div><div class="kg-card kg-callout-card kg-callout-card-grey"><div class="kg-callout-emoji">💡</div><div class="kg-callout-text"><strong>TIP: Give apps fake permissions</strong>. <br><a href="https://appops.rikka.app/">AppOps</a> allows you to set some app permissions to "ignored", which make it so that the app thinks that it does have a permission, but when it tries to actually use it, it doesn't get any data. AppOps has work-profile support.</div></div><h2 id="netguard">Netguard</h2><p>Netguard is a FOSS app that allows us to control exactly which apps have access to the internet, and which don't. We can give an app WiFi access, mobile data access, or make it so that netguard doesn't control the app at all. </p><h3 id="installing-the-app">Installing the app</h3><p>Here, we have two options: Installing from GitHub, or installing from F-Droid. We can't install netguard from the playstore because <strong>the playstore release doesn't support port-forwarding</strong>, and that feature is obligatory for us to be able to do our trick.</p><p>I recommend installing NetGuard from F-Droid, since it's easier to update it from there. If you don't already have an F-Droid client, I recommend using <a href="https://gitlab.com/AuroraOSS/auroradroid/-/releases">AuroraDroid</a>. Simply download the APK file, and install it. After opening the app and finishing the setup, search for "NetGuard" and install the first result.</p><p>I recommend spending some time fine-tweaking which apps you give internet access to. Most apps only ask for internet access to show you ads/collect analytics.</p><h2 id="why-personaldnsfilter">Why personalDNSfilter?</h2><p>The Netguard version from github already has hosts blacklists, so why not use just that? Well, Netguard's host blacklist implementation has a number of <a href="https://github.com/M66B/NetGuard/blob/master/ADBLOCKING.md">drawbacks</a>:</p><blockquote>NetGuard ignores the IP addresses in the hosts file, because it does not route blocked domains to localhost.</blockquote><blockquote>Wildcards are not supported due to performance and battery usage reasons.</blockquote><blockquote>It is not possible to edit the hosts file (change/add/delete domain names) with NetGuard</blockquote><p>Also:</p><ul><li>Host blocklists have to be updated manually.</li><li>You can't view exactly which domains have been blocked.</li><li>You can't create your own custom DNS resolutions: This is necessary if you're into self-hosting and you want HTTPS without a public domain.</li></ul><p><a href="https://www.zenz-solutions.de/personaldnsfilter-wp/">personalDNSfilter</a> overcomes all of these problems, and so for that reason I strongly recommend it.</p><h2 id="installing-personaldnsfilter">Installing personalDNSfilter</h2><p>This one's easy. You can either install it from F-Droid (using AuroraDroid), or you can install it from the playstore. They're both the same.</p><p>After installing the app, tap on "Advanced settings" and make them match this:</p><figure class="kg-card kg-image-card"><img src="https://itsignacioportal.github.io/content/images/2022/03/pDNSf-config-1.jpg" class="kg-image" alt="Screenshot of Advanced settings in personalDNSFilter. CNAME Cloaking protection: ON. DNS proxy mode without local VPN: ON. Allow only local DNS proxy requests: ON. Root mode without local VPN: OFF." loading="lazy" width="323" height="391"></figure><p>What we're doing here, is configuring pDNSf so it doesn't use a VPN slot, but instead opens a "DNS proxy" on port 5300. </p><h2 id="installing-the-socks5-proxy">Installing the SOCKS5 proxy</h2><p>Now, you must launch the Google Playstore from within Island:</p><figure class="kg-card kg-image-card"><img src="https://itsignacioportal.github.io/content/images/2022/03/island-launching-playstore-1.jpg" class="kg-image" alt="Screenshot of Launching the Google Playstore from within the Island app" loading="lazy" width="325" height="703"></figure><p>Now search and install "Every Proxy". "Every Proxy" has no ads, and no trackers, hence, why I picked it. Make sure NetGuard is up and running on the main profile, and then launch the EveryProxy app, and hit the three dots on the top left corner, then "Settings". Scroll down to the bottom and make your settings match this:</p><figure class="kg-card kg-image-card"><img src="https://itsignacioportal.github.io/content/images/2022/03/everyproxy-config-1.jpg" class="kg-image" alt="Screenshot of configuration for the SOCKS5 proxy in Every Proxy. IP Address: 10.1.10.1. Port: 1088. Power save: Off. Auto Start at startup: Off. Enable basic authentication: On. Username: redacted. Password: redacted. More secure: On. " loading="lazy" width="328" height="544"></figure><p>Of course, you must create a username and password. You don't really need to remember the password. Just copy it to your clipboard. (IMPORTANT: DO NOT make the password 126 characters long, else netguard will enter a crash loop that might crash your entire phone). Now go back to the main screen of the app, and start the SOCKS5 proxy. Make sure to disable battery optimizations for "Every Proxy", else Android might kill the app unexpectedly. If you don't know how to disable these optimizations, go to <a href="dontkillmyapp.com">dontkillmyapp.com</a>. </p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://itsignacioportal.github.io/content/images/2022/03/everyproxy-socks5-started-1.jpg" class="kg-image" alt="Screenshot of Every Proxy with SOCKS5 On." loading="lazy" width="327" height="355"><figcaption>"Every Proxy" with the SOCKS5 proxy activated</figcaption></figure><h2 id="configuring-netguard">Configuring Netguard</h2><p>Now you must go back to your main profile and open Netguard. Do NOT "Deactivate" the work profile.</p><p>Here's the tricky part. Go into NetGuard -&gt; Three Dots (on the top right corner) -&gt; Settings -&gt; Advanced Options -&gt; Port Forwarding</p><figure class="kg-card kg-image-card"><img src="https://itsignacioportal.github.io/content/images/2022/03/netguard-port-forwarding-1.jpg" class="kg-image" alt loading="lazy" width="327" height="260"></figure><p>Once you're inside that menu, click the "<strong>+</strong>" icon on the top right corner. Make the details match the following screenshot:</p><figure class="kg-card kg-image-card"><img src="https://itsignacioportal.github.io/content/images/2022/03/netguard-port-forwarding_detail-2.jpg" class="kg-image" alt="Screenshot of netguard configuration. Protocol: TCP. Destination address: 127.0.0.1. Destination port: 5300. Destination app: personalDNSFilter." loading="lazy" width="292" height="459"></figure><p>Click OK. Now do the exact same thing again, but instead of selecting "TCP", select "UDP".</p><p>Basically, what we're doing is configuring netguard so whenever an outbound DNS request goes through port 53, it will be redirected to localhost (127.0.0.1) to port 5300 to personalDNSFilter. We use port 5300 because that's the only port that pDNSf can work on without having root, without occupying the VPN slot.</p><p>Now go back to the main screen of the app. Look for "personalDNSFilter" and untick the "Apply rules and conditions" checkbox:</p><figure class="kg-card kg-image-card"><img src="https://itsignacioportal.github.io/content/images/2022/03/netguard-pdnsf-1.jpg" class="kg-image" alt="screenshot of personalDNSfilter being excluded from control by netguard." loading="lazy" width="326" height="191"></figure><p>We do this so that there isn't an infinite DNS loopback: For example, if Google Chrome wants to resolve example.com, then the request will go through NetGuard, which will use 127.0.0.1 as the DNS resolver. pDNSf will resolve it according to its configuration, but when it makes the outbound dns resolution request to it's configured DNS servers, that request will be caught by NetGuard, which will try to resolve it using 127.0.0.1, so pDNSf requests tries to resolve it, but its caught by NetGuard, who tries to resolve it using 127.0.0.1, so pDNSf requests tries to resolve it, and so on and so forth....</p><p>Now we have to configure netguard to use the SOCKS5 proxy. Go to NetGuard -&gt; Three Dots (on the top right corner) -&gt; Settings -&gt; Advanced Options and scroll down to the section about the SOCKS5 Proxies:</p><figure class="kg-card kg-image-card"><img src="https://itsignacioportal.github.io/content/images/2022/03/netguard-socks5-1.jpg" class="kg-image" alt="Netguard config screenshot. SOCKS5 address: 10.1.10.1. SOCKS5 port: 1088. Socks5 username: redacted. Socks5 password: redacted." loading="lazy" width="330" height="263"></figure><p>The "SOCKS5 username" and the "SOCKS5 password" must match the username and password that you configured on "Every Proxy".</p><p>Lastly, we have to configure the <em>VPN DNS</em>. Go to "Settings" -&gt; "Advanced Options" and scroll down. Set both "VPN DNS" settings to<strong> any WAN external server </strong>(Avoid "localhost", "127.0.0.1", "10.1.10.1", "192.168.0.1", and such. Copy me if you're not sure on what server to use). It doesn't matter what servers you pick here, your DNS requests won't be sent to these servers. The DNS requests will be redirected to pDNSf thanks to the forwarding rule we setup earlier.</p><p>Why not just put "127.0.0.1" as the VPN DNS you ask? To put it simply, NetGuard has DNS Leaks which can only be avoided using this hacky method. Without this workaround, who our ISP is would be exposed, and nobody wants that!</p><figure class="kg-card kg-image-card"><img src="https://itsignacioportal.github.io/content/images/2022/03/netguard_VPN-DNS.png" class="kg-image" alt loading="lazy" width="325" height="184"></figure><p> If you want more information about how this whole setup works, <a href="https://imgur.com/a/FDzrffF">click here</a>.</p><h2 id="installing-the-actual-vpn">Installing the actual VPN</h2><p>Finally! Just like you installed "Every Proxy" on the work profile, now do the same but instead look for the VPN that you want. In my case, I'll be using ProtonVPN.</p><p>After starting the VPN, if you did everything right, you should see some traffic starting to pop up on your VPN app:</p><figure class="kg-card kg-image-card"><img src="https://itsignacioportal.github.io/content/images/2022/03/protonvpn-1.jpg" class="kg-image" alt="Screenshot of ProtonVPN with traffic coming through." loading="lazy" width="294" height="574"></figure><p>You can verify that the VPN is working by going to any of the following sites with the VPN activated:</p><ul><li><a href="https://whatismyipaddress.com">whatismyipaddress.com</a></li><li><a href="https://browserleaks.org/dns">browserleaks.org/dns</a></li><li><a href="https://whoer.net">whoer.net</a></li></ul><p>Just make sure that your browser is controlled by NetGuard, else it will just bypass the entire system.</p><p>If you wish to <strong>disconnect </strong>from the VPN without dropping any packets, do this, in this specific order:</p><ul><li>Disable "Use SOCKS5 proxy" in NetGuard.</li><li>Stop your VPN app and the SOCKS5 proxy on "Every Proxy" (the order of these two steps doesn't matter, hence why they're combined in a single bullet point).</li><li>"Deactivate" the work profile using the notification from Island.</li></ul>
        </section>

        <div class="gh-canvas">
            <div class="center-horizontally">
                <br>
                <hr id="tophr">
                <h2>Having trouble?</h2>
                <p>For a one-time USD$10 donation you can <b>get one-on-one troubleshooting support</b> for any of my guides/projects. I'll help you fix <b>any issue</b> you may have encountered regarding usage/deployment of one of my guides. More info in <a href="https://web.archive.org/web/20250314003845/https://github.com/sponsors/ItsIgnacioPortal?o=esc" class="link">my Github Sponsors profile</a>.</p>
                <br>
                <iframe class="center-horizontally" id="github-sponsors-iframe" src="/content/media/github-sponsor-card.html" title="Sponsor ItsIgnacioPortal" width="100%" data-ruffle-polyfilled=""></iframe>
                <hr>
            </div>
        </div>
        
        <section class="article-comments gh-canvas">
            <script src="https://giscus.app/client.js" data-repo="itsignacioportal/itsignacioportal.github.io" data-repo-id="R_kgDOHCib7w" data-category="Announcements" data-category-id="DIC_kwDOHCib784COZ-J" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="dark" data-lang="en" data-loading="lazy" crossorigin="anonymous" async></script>
        </section>
        

    </article>
</main>


    <section class="footer-cta ">
        <div class="inner">
            <h2>Sign up for more like this.</h2>
            <a class="footer-cta-button" href="#/portal" data-portal>
                <div class="footer-cta-input">Enter your email</div>
                <span>Subscribe</span>
            </a>
        </div>
    </section>




            <aside class="read-more-wrap">
                <div class="read-more inner">
                        
<article class="post-card post ">

    <a class="post-card-image-link" href="/firewall-and-vpn-without-root-on-android-2025/">
        <img class="post-card-image"
            srcset="/content/images/size/w300/2025/07/ABSOLUTE-PRIVACY-5.jpg 300w,
                    /content/images/size/w600/2025/07/ABSOLUTE-PRIVACY-5.jpg 600w,
                    /content/images/size/w1000/2025/07/ABSOLUTE-PRIVACY-5.jpg 1000w,
                    /content/images/size/w2000/2025/07/ABSOLUTE-PRIVACY-5.jpg 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2025/07/ABSOLUTE-PRIVACY-5.jpg"
            alt="How to use a Firewall and a VPN at the same time on Android without root, without external self-hosted servers (2025)"
            loading="lazy"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/firewall-and-vpn-without-root-on-android-2025/">
            <header class="post-card-header">
                <h2 class="post-card-title">How to use a Firewall and a VPN at the same time on Android without root, without external self-hosted servers (2025)</h2>
            </header>
            <div class="post-card-excerpt">
                <p>✅ You're reading the latest version of this guide. It's often considered impossible to use both a firewall and a VPN at the same time on android without root, mainly due to the fact that you can normally only connect to a single VPN at a time, and firewall apps require</p>
            </div>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="/author/ignacio/" class="static-avatar">
                        <img class="author-profile-image" src="/content/images/size/w100/2025/06/Circle.png" alt="Ignacio J. Perez Portal" loading="lazy" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span class="post-card-byline-author"><a href="/author/ignacio/">Ignacio J. Perez Portal</a></span>
                <span class="post-card-byline-date"><time datetime="2025-06-24">Jun 24, 2025</time> <span class="bull">&bull;</span> 12 min read</span>
            </div>
        </footer>

    </div>

</article>
                        
<article class="post-card post no-image ">


    <div class="post-card-content">

        <a class="post-card-content-link" href="/transparent-compression-on-android/">
            <header class="post-card-header">
                <h2 class="post-card-title">Transparent data compression on Android</h2>
            </header>
            <div class="post-card-excerpt">
                <p>What is "transparent data compression"?Transparent data compression consists of storing data in a compressed format and automatically decompressing it whenever it needs to be accessed, making the whole process transparent to the user. Non-transparent methods of accessing compressed data may be cumbersome to the user, as they often require</p>
            </div>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="/author/ignacio/" class="static-avatar">
                        <img class="author-profile-image" src="/content/images/size/w100/2025/06/Circle.png" alt="Ignacio J. Perez Portal" loading="lazy" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span class="post-card-byline-author"><a href="/author/ignacio/">Ignacio J. Perez Portal</a></span>
                <span class="post-card-byline-date"><time datetime="2024-06-29">Jun 29, 2024</time> <span class="bull">&bull;</span> 2 min read</span>
            </div>
        </footer>

    </div>

</article>
                        
<article class="post-card post no-image ">


    <div class="post-card-content">

        <a class="post-card-content-link" href="/firewall-and-vpn-without-root-on-android/">
            <header class="post-card-header">
                <h2 class="post-card-title">How to use a Firewall and a VPN at the same time on Android without root, without external self-hosted servers.</h2>
            </header>
            <div class="post-card-excerpt">
                <p>IMPORTANT: This guide is now outdated. Use this one instead: https://itsignacioportal.github.io/firewall-and-vpn-without-root-on-android-2025/ Unlike the previous version of this guide, this setup has: No DNS leaks.No UDP leaks.Less battery usage.Only open-source software.RequirementsAndroid 5.0+Anywhere between 446.03 MB, up to 2500MB of available</p>
            </div>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="/author/ignacio/" class="static-avatar">
                        <img class="author-profile-image" src="/content/images/size/w100/2025/06/Circle.png" alt="Ignacio J. Perez Portal" loading="lazy" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span class="post-card-byline-author"><a href="/author/ignacio/">Ignacio J. Perez Portal</a></span>
                <span class="post-card-byline-date"><time datetime="2024-05-09">May 9, 2024</time> <span class="bull">&bull;</span> 8 min read</span>
            </div>
        </footer>

    </div>

</article>
                </div>
            </aside>



    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="https://itsignacioportal.github.io">ItsIgnacioPortal&#x27;s Blog</a> &copy; 2025</section>
            <section class="adsense-policy"><p>This site uses Google AdSense. <a href="https://www.google.com/policies/privacy/partners/">See How Google uses data when you use our partners’ sites or apps.</a></p></section>
            <nav class="site-footer-nav">
                <ul class="nav">
    <li class="nav-sign-up"><a href="#/portal/">Sign up</a></li>
</ul>

            </nav>
            <div><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>


<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="/assets/built/casper.js?v=d30f4e6105"></script>
<script integrity="sha256-nBdAVpkwk/0Wiw/Vz/Io1fPEjdBDnAO8Ah4/c8ASAmc=">
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

<script integrity="sha256-zZP2fMn+AftLcILRxH7nSMR78Jva5egmZLTEk+/cPks=">
/**Javascript for the collapsable content button**/
var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
	coll[i].addEventListener("click", function() {
		this.classList.toggle("active");
		if (this.innerHTML.startsWith("Open")){
			//background-color: #eee;
			this.innerHTML = this.innerHTML.replace("Open", "Close") 
		} else {
			this.innerHTML = this.innerHTML.replace("Close", "Open") 
		}

		var content = this.nextElementSibling;

		if (content.style.maxHeight){
			content.style.maxHeight = null;
		} else {
			content.style.maxHeight = content.scrollHeight + 36 + "px";
		} 
	});
}
</script>
<script src="/assets/js/lib/prism.js"></script>

</body>
</html>
